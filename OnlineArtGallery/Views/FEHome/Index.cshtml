@using OnlineArtGallery.Models.Entities;
@functions {
    public int RatingCount(int id)
    {
        GalleryArtEntities db = new GalleryArtEntities();
        var count = db.Ratings.Where(a => a.artwork_id == id).ToList().Count();
        return count;
    }
    public double Star(int id)
    {
        GalleryArtEntities db = new GalleryArtEntities();
        var star = db.Ratings.Where(a => a.artwork_id == id).ToList();
        double percent = 0;
        if (star.Count() != 0)
        {
            percent = (star.Average(a => a.rating_start)) / 5 * 100;
            return percent;
        }

        return percent;
    }
}
@section main
{
    <div class="intro-section pt-lg-2">
        <div class="container">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img class="d-block w-100" src="https://media.vov.vn/sites/default/files/styles/large/public/2022-01/4_64.jpg" style="max-height: 500px; object-fit: cover" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="https://media.vov.vn/sites/default/files/styles/large/public/2022-01/6_47.jpg" style="max-height: 500px; object-fit: cover" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block w-100" src="https://toigingiuvedep.vn/wp-content/uploads/2021/02/buc-tranh-starry-night-over-the-rhone.jpg" style="max-height: 500px; object-fit: cover" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </div>

        <div class="icon-boxes-container bg-transparent">
            <div class="container">
                <div class="row">
                    <div class="col-sm-6 col-lg-3">
                        <div class="icon-box icon-box-side">
                            <span class="icon-box-icon">
                                <i class="icon-truck"></i>
                            </span>
                            <div class="icon-box-content">
                                <h3 class="icon-box-title">Payment & Delivery</h3><!-- End .icon-box-title -->
                                <p>Free shipping for orders over $50</p>
                            </div><!-- End .icon-box-content -->
                        </div><!-- End .icon-box -->
                    </div><!-- End .col-sm-6 col-lg-3 -->

                    <div class="col-sm-6 col-lg-3">
                        <div class="icon-box icon-box-side">
                            <span class="icon-box-icon">
                                <i class="icon-rotate-left"></i>
                            </span>

                            <div class="icon-box-content">
                                <h3 class="icon-box-title">Return & Refund</h3><!-- End .icon-box-title -->
                                <p>Free 100% money back guarantee</p>
                            </div><!-- End .icon-box-content -->
                        </div><!-- End .icon-box -->
                    </div><!-- End .col-sm-6 col-lg-3 -->

                    <div class="col-sm-6 col-lg-3">
                        <div class="icon-box icon-box-side">
                            <span class="icon-box-icon">
                                <i class="icon-life-ring"></i>
                            </span>

                            <div class="icon-box-content">
                                <h3 class="icon-box-title">Quality Support</h3><!-- End .icon-box-title -->
                                <p>Alway online feedback 24/7</p>
                            </div><!-- End .icon-box-content -->
                        </div><!-- End .icon-box -->
                    </div><!-- End .col-sm-6 col-lg-3 -->

                    <div class="col-sm-6 col-lg-3">
                        <div class="icon-box icon-box-side">
                            <span class="icon-box-icon">
                                <i class="icon-envelope"></i>
                            </span>

                            <div class="icon-box-content">
                                <h3 class="icon-box-title">Join Our Newsletter</h3><!-- End .icon-box-title -->
                                <p>10% off by subscribing to our newsletter</p>
                            </div><!-- End .icon-box-content -->
                        </div><!-- End .icon-box -->
                    </div><!-- End .col-sm-6 col-lg-3 -->
                </div><!-- End .row -->
            </div><!-- End .container -->
        </div><!-- End .icon-boxes-container -->
    </div><!-- End .intro-section -->

    <div class="bestseller-products bg-light pt-5 pb-5 mb-5">
        <div class="block">
            <div class="block-wrapper ">
                <div class="container">
                    <div class="heading heading-flex">
                        <div class="heading-left">
                            <h2 class="title">New Artworks</h2><!-- End .title -->
                        </div><!-- End .heading-left -->

                        <div class="heading-right">
                            <a href="/FEArtwork/ArtworkList" class="title-link">View more Products <i class="icon-long-arrow-right"></i></a>
                        </div><!-- End .heading-right -->
                    </div><!-- End .header-flex -->

                    <div class="owl-carousel carousel-equal-height owl-simple" data-toggle="owl"
                         data-owl-options='{
                                    "nav": false,
                                    "dots": true,
                                    "margin": 20,
                                    "loop": false,
                                    "responsive": {
                                        "0": {
                                            "items":2
                                        },
                                        "480": {
                                            "items":2
                                        },
                                        "768": {
                                            "items":3
                                        },
                                        "992": {
                                            "items":4
                                        },
                                        "1440": {
                                            "items":4
                                        }
                                    }
                                }'>
                        @foreach (var art in ViewBag.ArtworkTop)
                        {
                            <div class="product">
                                <figure class="product-media">
                                    <a href="/FEArtwork/ArtworkDetail/@art.artwork_id">
                                        <img style="height:200px" src="~/Content/assets/images/artwork/@art.artwork_image" alt="Product image" class="product-image">
                                    </a>
                                </figure><!-- End .product-media -->

                                <div class="product-body">
                                    <div class="product-cat">
                                        by <a href="#">@art.Artist.artist_name</a>
                                    </div><!-- End .product-cat -->
                                    <h3 class="product-title"><a href="/FEArtwork/ArtworkDetail/@art.artwork_id">@art.artwork_name</a></h3><!-- End .product-title -->
                                    <div class="product-price">
                                        <span class="new-price">$@art.artwork_price</span>

                                    </div><!-- End .product-price -->

                                    <div class="product-footer">
                                        <div class="ratings-container">
                                            <div class="ratings">
                                                <div class="ratings-val" style="width: @Star(art.artwork_id)%;"></div><!-- End .ratings-val -->
                                            </div><!-- End .ratings -->
                                            <span class="ratings-text">( @RatingCount(art.artwork_id) Reviews )</span>
                                        </div><!-- End .rating-container -->
                                        <div class="product-action">
                                            @if (Session["UserId"] != null)
                                            {
                                                <a href="" data-cart-id="@art.artwork_id" class="btn-product btn-cart cart"><span>add to cart</span></a>
                                                <a href="" data-wishlist-id="@art.artwork_id" class="btn-product btn-wishlist wishlist"><span>Add to Wishlist</span></a>

                                            }
                                            else
                                            {
                                                <a href="#signin-modal" data-toggle="modal" class="btn-product btn-cart "><span>add to cart</span></a>
                                                <a href="#signin-modal" data-toggle="modal" class="btn-product btn-wishlist "><span>Add to Wishlist</span></a>
                                            }
                                        </div><!-- End .product-action -->
                                    </div><!-- End .product-footer -->
                                </div><!-- End .product-body -->
                            </div><!-- End .product -->
                        }
                    </div><!-- End .owl-carousel -->
                </div><!-- End .container -->
            </div><!-- End .block-wrapper -->
        </div><!-- End .block -->
    </div><!-- End .bg-light pt-4 pb-4 -->

    <div class="mb-5"></div><!-- End .mb-3 -->

    <div class="banner-group mb-2">
        <div class="container">
            <div class="heading heading-flex">
                <div class="heading-left">
                    <h2 class="title">Galleries</h2><!-- End .title -->
                </div><!-- End .heading-left -->
            </div><!-- End .header-flex -->
            <div class="row justify-content-center">
                @foreach (var gal in ViewBag.GalleryTop)
                {
                    <div class="col-md-6 col-lg-4">
                        <div class="banner banner-overlay">
                            <a href="#">
                                <img style="height:300px" src="~/Content/assets/images/galleryimg/@gal.gallery_image" alt="Banner">
                            </a>

                            <div class="banner-content">
                                <h4 class="banner-subtitle text-white"><a href="#">A Perfect Choice For Your Children</a></h4><!-- End .banner-subtitle -->
                                <h3 class="banner-title text-white"><a href="#">@gal.gallery_name</a></h3><!-- End .banner-title -->
                                <a href="#" class="btn btn-outline-white-3 banner-link">Discover Now<i class="icon-long-arrow-right"></i></a>
                            </div><!-- End .banner-content -->
                        </div><!-- End .banner -->
                    </div><!-- End .col-lg-4 -->
                }
            </div><!-- End .row -->
        </div><!-- End .container -->
    </div><!-- End .banner-group -->

    <div class="mb-5"></div><!-- End .mb-5 -->

    <div class="bestseller-products bg-light pt-5 pb-5">
        <div class="block">
            <div class="block-wrapper ">
                <div class="container">
                    <div class="heading heading-flex">
                        <div class="heading-left">
                            <h2 class="title">New Auction</h2><!-- End .title -->
                        </div><!-- End .heading-left -->

                        <div class="heading-right">
                            <a href="/FEArtwork/ArtworkList" class="title-link">View more Products <i class="icon-long-arrow-right"></i></a>
                        </div><!-- End .heading-right -->
                    </div><!-- End .header-flex -->
                    <div class="products">
                        <div class="row">
                            @foreach (var art in ViewBag.AuctionTop)
                            {
                                <div class="col-6 col-md-4 col-lg-4 col-xl-3">
                                    <div class="product">
                                        <figure class="product-media m-0">
                                            <span class="product-label label-new">New</span>
                                            <a href="/FEArtwork/ArtworkDetail/@art.artwork_id">
                                                <img src="~/Content/assets/images/artwork/@art.Artwork.artwork_image" style="height: 200px; object-fit:cover" alt="Product image" class="product-image">
                                            </a>
                                            <div class="bg-dark text-center text-white countdown" style="opacity: .5;" data-start="@art.auction_start_date" data-end="@art.auction_end_date">
                                                <strong>

                                                </strong>
                                            </div>
                                        </figure>

                                        <div class="product-body">
                                            <div class="product-cat">
                                                <a href="#">@art.Artwork.Category.category_name</a>
                                            </div><!-- End .product-cat -->
                                            <h3 class="product-title mb-1"><a href="/FEArtwork/ArtworkDetail/@art.artwork_id"><strong>@art.Artwork.artwork_name</strong></a></h3><!-- End .product-title -->
                                            <div class="product-price mb-1">
                                                Reserve Price:&nbsp <span class="badge bg-success text-white" style="font-size: 15px">$@art.auction_reserve_price</span>
                                            </div><!-- End .product-price -->
                                            <div class="product-price">
                                                Current Bid:&nbsp <span class="badge bg-danger text-white" style="font-size: 15px">$@art.auction_reserve_price</span>
                                            </div>
                                            <div class="form-group mt-1 row align-items-center">
                                                <label class="form-label col-sm-3 m-0">Your bid: </label>
                                                <div class="input-group col-sm-9">
                                                    <span class="input-group-text " style="height: 40px;">$</span>
                                                    <input class="form-control form-control-sm" onkeypress="return validateNumber(event)" onpaste="return false;" oncopy="return false"/>
                                                </div>
                                            </div>
                                            <div class="form-submit">
                                                @if (Session["UserId"] == null)
                                                {
                                                    <button href="#signin-modal" data-toggle="modal" class="btn btn-primary w-100">Quick bid</button>
                                                }
                                                else
                                                {
                                                    <button class="btn btn-primary w-100">Quick bid</button>
                                                }

                                            </div>
                                        </div><!-- End .product-body -->
                                    </div><!-- End .product -->
                                </div>
                            }
                        </div><!-- End .row -->

                        <div class="load-more-container text-center">
                            <a href="#" class="btn btn-outline-darker btn-load-more">More Auctions <i class="icon-refresh"></i></a>
                        </div><!-- End .load-more-container -->
                    </div>
                </div><!-- End .container -->
            </div><!-- End .block-wrapper -->
        </div><!-- End .block -->
    </div><!-- End .bg-light pt-4 pb-4 -->

}